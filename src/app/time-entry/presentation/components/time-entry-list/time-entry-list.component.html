<div class="time-entry-list-container">

  <div class="top-actions-group">
    <!-- 1. PÍLDORA (Utilidades) -->
    <div class="utility-pill">
      <!-- Compartir Reporte -->
      <button mat-icon-button class="glass-icon-btn" (click)="shareReport()"
        matTooltip="Enviar Reporte (WhatsApp/iOS Share)" matTooltipPosition="above">
        <mat-icon>ios_share</mat-icon>
      </button>

      <!-- Backup (Exportar) -->
      <button mat-icon-button class="glass-icon-btn" (click)="handleExport()"
        matTooltip="Crear copia de seguridad (JSON)" matTooltipPosition="above">
        <mat-icon>cloud_upload</mat-icon> <!-- Ícono más descriptivo para Backup -->
      </button>

      <div class="vertical-divider"></div>

      <!-- Restore (Importar) -->
      <button mat-icon-button class="glass-icon-btn" (click)="fileInput.click()" matTooltip="Restaurar desde archivo"
        matTooltipPosition="above">
        <mat-icon>settings_backup_restore</mat-icon>
      </button>
      <input #fileInput type="file" (change)="handleImport($event)" accept=".json" hidden>
    </div>

    <!-- 2. CÍRCULO (Add) -->
    <div class="primary-action-wrapper">
      <button mat-fab class="glass-fab-circle" (click)="addEntry()" matTooltip="Nuevo Registro"
        matTooltipPosition="left">
        <mat-icon>add</mat-icon>
      </button>
    </div>
  </div>


  <div class="month-selector-container">
    <div class="glass-paginator">
      <button mat-icon-button (click)="prevMonth()" class="nav-btn">
        <mat-icon>chevron_left</mat-icon>
      </button>

      <div class="month-display">
        <span class="month-text">{{ currentDate() | date:'MMMM' }}</span>
        <span class="year-text">{{ currentDate() | date:'yyyy' }}</span>
      </div>

      <button mat-icon-button (click)="nextMonth()" class="nav-btn">
        <mat-icon>chevron_right</mat-icon>
      </button>

      <div class="v-divider"></div>

      <button mat-button (click)="goToToday()" [disabled]="isCurrentMonth()" class="today-pill-btn">
        {{ 'common.buttons.today' | translate }}
      </button>
    </div>
  </div>



  <!-- Totals Summary Card -->
  <section class="totals-dashboard">
    <!-- Tarjeta de Horas -->
    <div class="glass-tile primary">
      <div class="tile-icon">
        <mat-icon>schedule</mat-icon>
      </div>
      <div class="tile-info">
        <span class="tile-label">{{ 'timeEntry.totalHours' | translate }}</span>
        <h2 class="tile-value">{{ facade.totals()?.totalHours ?? 0 }}</h2>
      </div>
      <div class="tile-decoration"></div>
    </div>

    <!-- Tarjeta de Cursos -->
    <div class="glass-tile tertiary">
      <div class="tile-icon">
        <mat-icon>school</mat-icon>
      </div>
      <div class="tile-info">
        <span class="tile-label">{{ 'timeEntry.totalCourses' | translate }}</span>
        <h2 class="tile-value">{{ facade.totals()?.totalCourses ?? 0 }}</h2>
      </div>
      <div class="tile-decoration"></div>
    </div>
  </section>


  <!-- List of Days -->
  <section class="days">
    <ma-time-entry-day *ngFor="let group of groupedEntries()" [date]="group.date" [entries]="group.entries"
      (edit)="editEntry($event)">
    </ma-time-entry-day>
  </section>

</div>